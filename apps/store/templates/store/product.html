{% extends "core/base.html" %}
{% load static %}
{% load humanize %}
{% load i18n %}


{% block page_content %}
    <main id="main-page" class="main">
        <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
            <div class="container d-flex align-items-center">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index-1.html">خانه</a></li>
                    <li class="breadcrumb-item"><a href="#">محصولات</a></li>
                    <li class="breadcrumb-item active" aria-current="page">پیش فرض</li>
                </ol>

                <nav class="product-pager mr-auto" aria-label="Product">
                    <a class="product-pager-link product-pager-prev" {% if prev_product %}
                       href="{% url "store:product-code-slug"  prev_product.code prev_product.slug %}" {% endif %}
                       aria-label="Previous" tabindex="-1">
                        <i class="icon-angle-right"></i>
                        <span>قبلی</span>
                    </a>

                    <a class="product-pager-link product-pager-next"{% if next_product %}
                       href="{% url "store:product-code-slug"  next_product.code next_product.slug %}"{% endif %}
                       aria-label="Next" tabindex="-1">
                        <span>بعدی</span>
                        <i class="icon-angle-left"></i>
                    </a>
                </nav><!-- End .pager-nav -->
            </div><!-- End .container -->
        </nav><!-- End .breadcrumb-nav -->
        <div class="page-content">
            <div class="container">
                <div class="product-details-top">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="product-gallery product-gallery-vertical">
                                <div class="row">
                                    <figure class="product-main-image">
                                        <img id="product-zoom" src="{% static "core/en/images/products/single/1.jpg" %}"
                                             data-zoom-image="{% static "core/en/images/products/single/1-big.jpg" %}"
                                             alt="تصویر محصول">

                                        <a href="#" id="btn-product-gallery" class="btn-product-gallery">
                                            <i class="icon-arrows"></i>
                                        </a>
                                    </figure><!-- End .product-main-image -->

                                    <div id="product-zoom-gallery" class="product-image-gallery">
                                        {% for picture in product.image_set.all %}
                                            <a class="product-gallery-item">
                                                <img src="{{ picture.image_file.url }}"
                                                     alt="توضیحات تصویر">
                                            </a>
                                        {% endfor %}
                                    </div><!-- End .product-image-gallery -->
                                </div><!-- End .row -->
                            </div><!-- End .product-gallery -->
                        </div><!-- End .col-md-6 -->

                        <div class="col-md-6">
                            <div class="product-details">
                                <h1 class="product-title">{{ product.title }}</h1>
                                <!-- End .product-title -->

                                <div class="ratings-container">
                                    <div class="ratings">
                                        <div class="ratings-val" style="width: 80%;"></div><!-- End .ratings-val -->
                                    </div><!-- End .ratings -->
                                    <a class="ratings-text" href="#product-review-link" id="review-link">( 2 نظر
                                        )</a>
                                </div><!-- End .rating-container -->

                                <div class="product-price">
                                    {{ product.price }} تومان
                                </div><!-- End .product-price -->

                                <div class="product-content">
                                    <p class="text-justify">{{ product.intro }}</p>
                                </div><!-- End .product-content -->
                                <div class="row">
                                    <div class="col-4">
                                        <div class="row mt-1">
                                            <div class="col-3">
                                                <p class="mt-1">
                                                    تعداد
                                                </p>
                                            </div>
                                            <div class="col-9">
                                                <form id="cart-add"

                                                      action="{% url "store:cart" %}"
                                                >
                                                    <input
                                                            name="quantity"
                                                            type="number"

                                                            class="form-control"
                                                            value="1"
                                                            min="{{ product.minimum_order_quantity }}"
                                                            max="{{ product.maximum_order_quantity }}"
                                                            step="1" data-decimals="0" required=""
                                                            style="display: none;">
                                                    <input type="number" name="product" hidden value="{{ product.id }}">
                                                    <input type="text" name="cart" hidden value="{{ request.cart.id }}">
                                                    <input type="text" name="request_type" hidden value="add">
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-4">
                                        <a class="btn-product btn-cart pt-0 mt-2"
                                           style=" cursor: pointer;"
                                           onclick="cartAddOnclick()"
                                        >
                                            <span data-formid="cart-add"
                                                  data-cartwidgeturl="{% url "store:cart-widget" %}"
                                                  data-carturl="{% url "store:cart" %}"
                                            >افزودن به سبد خرید</span>
                                        </a>
                                    </div>
                                    <div class="col-4">
                                        <div class="details-action-wrapper">
                                            <form id="whish-add-{{ product.id }}">
                                                <input type="number" name="product" hidden value="{{ product.id }}">
                                                <input type="text" name="cart" hidden value="{{ request.cart.id }}">
                                                <input type="text" name="request_type" hidden value="add">
                                            </form>
                                            <a
                                                    style="cursor: pointer"
                                                    id="wish-button-{{ product.id }}"
                                                    {% if product.id in product_in_wishlist %}
                                                    class="btn-product btn-wishlist pt-0 mt-2 in-wish"
                                                    {% else %}
                                                    class="btn-product btn-wishlist pt-0 mt-2"
                                                    {% endif %}
                                                    title="لیست علاقه مندی"
                                            >
                                                <span
                                                        style=" cursor: pointer;"
                                                        onclick="wishItemAddOnclick()"
                                                        data-formid="whish-add-{{ product.id }}"
                                                        data-whishurl="{% url "store:whishlist" %}"
                                                        data-wishbutton="wish-button-{{ product.id }}"
                                                >  افزودن به  علاقه مندی</span>
                                            </a>
                                        </div><!-- End .details-action-wrapper -->
                                    </div>
                                </div>

                                {#                                <div class="product-details-footer">#}
                                {#                                    <div class="product-cat text-center">#}
                                {#                                        <span>دسته بندی : </span>#}
                                {#                                        <a href="#">{{ product.category.name }}</a>،#}
                                {#                                    </div><!-- End .product-cat -->#}
                                {##}
                                {#                                    <div class="social-icons social-icons-sm">#}
                                {#                                        <span class="social-label">اشتراک گذاری : </span>#}
                                {#                                        <a href="#" class="social-icon" title="فیسبوک" target="_blank"><i#}
                                {#                                                class="icon-facebook-f"></i></a>#}
                                {#                                        <a href="#" class="social-icon" title="توییتر" target="_blank"><i#}
                                {#                                                class="icon-twitter"></i></a>#}
                                {#                                        <a href="#" class="social-icon" title="اینستاگرام" target="_blank"><i#}
                                {#                                                class="icon-instagram"></i></a>#}
                                {#                                        <a href="#" class="social-icon" title="پینترست" target="_blank"><i#}
                                {#                                                class="icon-pinterest"></i></a>#}
                                {#                                    </div>#}
                                {#                                </div><!-- End .product-details-footer -->#}
                            </div><!-- End .product-details -->
                        </div><!-- End .col-md-6 -->
                    </div><!-- End .row -->
                </div><!-- End .product-details-top -->

                <div class="product-details-tab">
                    <ul class="nav nav-pills justify-content-center" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="product-desc-link" data-toggle="tab" href="#product-desc-tab"
                               role="tab" aria-controls="product-desc-tab"
                               aria-selected="true">{% translate "Description" %}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="product-info-link" data-toggle="tab" href="#product-info-tab"
                               role="tab"
                               aria-controls="product-info-tab"
                               aria-selected="false">{% translate "More information" %}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="product-shipping-link" data-toggle="tab"
                               href="#product-shipping-tab"
                               role="tab" aria-controls="product-shipping-tab"
                               aria-selected="false">{% translate "Sending and returning" %}</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" id="product-review-link" data-toggle="tab" href="#product-review-tab"
                               role="tab" aria-controls="product-review-tab"
                               aria-selected="false">{% translate "Comments" %}
                                ({{ reviews|length }})</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane fade show active" id="product-desc-tab" role="tabpanel"
                             aria-labelledby="product-desc-link">
                            <div class="product-desc-content">
                                {{ product.description | safe }}
                            </div><!-- End .product-desc-content -->
                        </div><!-- .End .tab-pane -->
                        <div class="tab-pane fade" id="product-info-tab" role="tabpanel"
                             aria-labelledby="product-info-link">
                            <div class="product-desc-content">
                                {{ product.more_info | safe }}
                            </div><!-- End .product-desc-content -->
                        </div><!-- .End .tab-pane -->
                        <div class="tab-pane fade" id="product-shipping-tab" role="tabpanel"
                             aria-labelledby="product-shipping-link">
                            <div class="product-desc-content">
                                {{ product.send_and_return | safe }}
                            </div><!-- End .product-desc-content -->
                        </div><!-- .End .tab-pane -->
                        <div class="tab-pane fade" id="product-review-tab" role="tabpanel"
                             aria-labelledby="product-review-link">
                            <div class="reviews">
                                {% for review in reviews %}
                                    <div class="review">
                                        <div class="row no-gutters">
                                            <div class="col-auto">
                                                <div class="ratings-container">
                                                    <div class="ratings">
                                                        <div class="ratings-val"
                                                             style="width: {{ review.rate }}%;"></div>
                                                        <!-- End .ratings-val -->
                                                    </div><!-- End .ratings -->
                                                </div><!-- End .rating-container -->
                                                <span class="review-date">4 روز پیش</span>
                                            </div><!-- End .col -->
                                            <div class="col-12">
                                                <h4>{{ review.title }}</h4>

                                                <div class="review-content">
                                                    <p>{{ review.comment }}</p>
                                                </div><!-- End .review-content -->

                                                <div class="review-action">
                                                    <a href="#"><i class="icon-thumbs-up"></i>مثبت
                                                        ({{ review.like }})</a>
                                                    <a href="#"><i class="icon-thumbs-down"></i>منفی
                                                        ({{ review.dislike }})</a>
                                                </div><!-- End .review-action -->
                                            </div><!-- End .col-auto -->
                                        </div><!-- End .row -->
                                    </div><!-- End .review -->
                                {% endfor %}
                                <div class="reply-prodeuct">
                                    <div class="heading">
                                        <h3 class="title">ارسال یک دیدگاه</h3><!-- End .title -->
                                        <p class="title-desc">ایمیل شما منتشر نخواهد شد، فیلد های اجباری با علامت * مشخص
                                            شده اند.</p>
                                    </div><!-- End .heading -->

                                    <form method="post">
                                        {% if form.errors %}
                                            <script>
                                                {% for error in form.non_field_errors %}
                                                    alertify.error("{{ error }}");
                                                {% endfor %}
                                            </script>
                                        {% endif %}
                                        {% csrf_token %}
                                        <div class="row">
                                            <div class="col-lg-4 form-req-text">
                                                {{ form.product }}
                                                {{ form.title.label_tag }}
                                                {{ form.title }}
                                                {{ form.title.errors.as_text }}
                                            </div>
                                            <div class="col-lg-4 form-req-text">
                                                {{ form.name.label_tag }}
                                                {{ form.name }}
                                                {{ form.name.errors.as_text }}
                                            </div>
                                            <div class="col-lg-4 form-req-text">
                                                {{ form.email.label_tag }}
                                                {{ form.email }}
                                                {{ form.email.errors.as_text }}
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-12 form-req-text">
                                                {{ form.comment.label_tag }}
                                                {{ form.comment }}
                                                {{ form.comment.errors.as_text }}
                                                {{ form.post }}
                                            </div>
                                        </div>
                                        <div class="row mt-3">
                                            <div class="col-3">
                                                    <input
                                                            name="rate"
                                                            class="rating"
                                                            max="5"
                                                            oninput="this.style.setProperty('--value', `${this.valueAsNumber}`)"
                                                            step="0.5"
                                                            style="--value:2.5"
                                                            type="range"
                                                            value="2.5">
                                                </label>
                                            </div>
                                            <div class="col-9">
                                                <div class="row">
                                                    <div class="col-8">
                                                        {{ form.captcha }}
                                                        {{ form.captcha.errors }}
                                                        {% if form.captcha.help_text %}
                                                            <p class="help">{{ form.captcha.help_text|safe }}</p>
                                                        {% endif %}
                                                    </div>
                                                    <div class="col-4">
                                                        <button class="btn btn-primary my-3 mr-2"
                                                                style="max-width: 70px;">
                                                            {% translate "Submit" %}
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                </div><!-- End .reply -->
                            </div><!-- End .نظر -->
                        </div><!-- .End .tab-pane -->
                    </div><!-- End .tab-content -->
                </div><!-- End .product-details-tab -->

                <h2 class="title text-center mb-4">محصولاتی که شاید بپسندید</h2><!-- End .title text-center -->

                <div class="owl-carousel owl-simple carousel-equal-height carousel-with-shadow owl-rtl owl-loaded owl-drag"
                     data-toggle="owl" data-owl-options="{
                            &quot;nav&quot;: false,
                            &quot;dots&quot;: true,
                            &quot;margin&quot;: 20,
                            &quot;loop&quot;: false,
                            &quot;rtl&quot;: true,
                            &quot;responsive&quot;: {
                                &quot;0&quot;: {
                                    &quot;items&quot;:1
                                },
                                &quot;480&quot;: {
                                    &quot;items&quot;:2
                                },
                                &quot;768&quot;: {
                                    &quot;items&quot;:3
                                },
                                &quot;992&quot;: {
                                    &quot;items&quot;:4
                                },
                                &quot;1200&quot;: {
                                    &quot;items&quot;:4,
                                    &quot;nav&quot;: true,
                                    &quot;dots&quot;: false
                                }
                            }
                        }">
                    <div class="owl-stage-outer">
                        <div class="owl-stage"
                             style="transform: translate3d(0px, 0px, 0px); transition: all 0s ease 0s; width: 1485px;">
                            {% for same_product in same_products %}
                                <div class="owl-item " style="width: 277px; margin-left: 20px;">
                                    <div class="product product-7 text-center">
                                        <figure class="product-media">
                                            <span class="product-label label-new">جدید</span>
                                            <a href="product.html">
                                                <img src="{{ same_product.introduction_picture.url }}"
                                                     alt="{{ same_product.introduction_picture.alt }}"
                                                     class="product-image">
                                            </a>

                                            <div class="product-action-vertical">
                                                {#                                                <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>افزودن به#}
                                                {#                                            لیست علاقه مندی</span></a>#}
                                                <a href="#" class="btn-product-icon btn-quickview"
                                                   title="مشاهده سریع"><span>مشاهده سریع</span></a>
                                                {#                                                <a href="#" class="btn-product-icon btn-compare" title="مقایسه"><span>لیست#}
                                                {#                                            مقایسه</span></a>#}
                                            </div><!-- End .product-action-vertical -->

                                            {#                                            <div class="product-action">#}
                                            {#                                                <a href="#" class="btn-product btn-cart"><span>افزودن به سبد خرید</span></a>#}
                                            {#                                            </div><!-- End .product-action -->#}
                                        </figure><!-- End .product-media -->

                                        <div class="product-body">
                                            <div class="product-cat text-center">
                                                <a href="#">{{ same_product.category.name }}</a>
                                            </div><!-- End .product-cat -->
                                            <h3 class="product-title text-center"><a href="product.html">
                                                {{ same_product.title }}
                                            </a>
                                            </h3>
                                            <!-- End .product-title -->
                                            <div class="ratings-container">
                                                <div class="ratings">
                                                    <div class="ratings-val"
                                                         style="width: {{ same_product.rate }}%;"></div>
                                                    <!-- End .ratings-val -->
                                                </div><!-- End .ratings -->
                                                <span class="ratings-text">( {{ same_product.reviws }} دیدگاه )</span>
                                            </div><!-- End .rating-container -->
                                        </div><!-- End .product-body -->
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="owl-nav">
                        <button type="button" role="presentation" class="owl-prev disabled"><i
                                class="icon-angle-left"></i>
                        </button>
                        <button type="button" role="presentation" class="owl-next"><i class="icon-angle-right"></i>
                        </button>
                    </div>
                    <div class="owl-dots disabled"></div>
                </div><!-- End .owl-carousel -->
            </div><!-- End .container -->
        </div>
{% endblock %}